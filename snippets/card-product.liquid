{% comment %}
  Renders a product card

  Accepts:
  - card_product: {Object} Product Liquid object (optional)
  - show_secondary_image: {Boolean} Show the secondary image on hover. Default: false (optional)
  - show_vendor: {Boolean} Show the product vendor. Default: false
  - show_rating: {Boolean} Show the product rating. Default: false
  - lazy_load: {Boolean} Image should be lazy loaded. Default: true (optional)
  - skip_styles: {Boolean} Don't include component styles. Useful when rendering multiple product cards in a loop. Default: false (optional)
  - quick_add: {Boolean} Show the quick add button.
  - section_id: {String} The ID of the section that contains this card.
  - horizontal_class: {Boolean} Add a card--horizontal class if set to true. Default: false (optional)
  - placeholder_image: {String} The placeholder image to use when no product exists. Default: 'product-apparel-2' (optional)

  Usage:
  {% render 'card-product', show_vendor: section.settings.show_vendor %}
{% endcomment %}

{%- unless skip_styles -%}
  {{ 'custom-card.css' | asset_url | stylesheet_tag }}
  <script src="{{ 'custom-card.js' | asset_url }}" defer="defer"></script>
  {{ 'component-rating.css' | asset_url | stylesheet_tag }}
  {{ 'component-volume-pricing.css' | asset_url | stylesheet_tag }}
  {{ 'component-price.css' | asset_url | stylesheet_tag }}
  {{ 'quick-order-list.css' | asset_url | stylesheet_tag }}
  {{ 'quantity-popover.css' | asset_url | stylesheet_tag }}
{%- endunless -%}

{%- if card_product and card_product != empty -%}
  <div class="product-card-1">
   {% if card_product.compare_at_price > card_product.price %} 
     <span class="product-card-1__badge">Sale</span> 
   {% endif %} 
  
  {% comment %}
   <button class="product-card-1__wishlist" aria-label="Add to Wishlist"> 
     <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg> 
   </button> 
   {% endcomment %}
  
   <a href="{{ card_product.url }}" class="product-card-1__image-wrap"> 
     <img 
       src="{{ card_product.featured_media | image_url: width: 600 }}" 
       alt="{{ card_product.featured_media.alt | escape }}" 
       {% unless lazy_load == false %}loading="lazy"{% endunless %}
       width="600" 
       height="600" 
     > 
     {%- if card_product.media[1] != null and show_secondary_image -%}
        <img 
            src="{{ card_product.media[1] | image_url: width: 600 }}" 
            alt="{{ card_product.media[1].alt | escape }}" 
            class="secondary-image"
            loading="lazy"
            width="600" 
            height="600"
            style="position: absolute; top: 0; left: 0; opacity: 0; transition: opacity 0.3s;"
        >
     {%- endif -%}
   </a> 
  
   <div class="product-card-1__info"> 
     {%- if show_vendor -%} 
       <span class="visually-hidden">{{ 'accessibility.vendor' | t }}</span> 
       <div class="caption-with-letter-spacing light">{{ card_product.vendor }}</div> 
     {%- endif -%}

     <!-- Start of Judge.me code -->
     <div style='{{ jm_style }}' class='jdgm-widget jdgm-preview-badge' data-id='{{ card_product.id }}' data-auto-install='false'> 
       {{ card_product.metafields.judgeme.badge }} 
     </div> 
     <!-- End of Judge.me code -->

     {%- if show_rating and card_product.metafields.reviews.rating.value != blank -%}
       {% liquid
         assign rating_decimal = 0
         assign decimal = card_product.metafields.reviews.rating.value.rating | modulo: 1
         if decimal >= 0.3 and decimal <= 0.7
           assign rating_decimal = 0.5
         elsif decimal > 0.7
           assign rating_decimal = 1
         endif
       %}
       <div class="product-card-1__rating">
         <div class="rating" role="img" aria-label="{{ 'accessibility.star_reviews_info' | t: rating_value: card_product.metafields.reviews.rating.value, rating_max: card_product.metafields.reviews.rating.value.scale_max }}">
           <span aria-hidden="true" class="rating-star" style="--color-rating-star: #FFC107; --rating: {{ card_product.metafields.reviews.rating.value.rating | floor }}; --rating-max: {{ card_product.metafields.reviews.rating.value.scale_max }}; --rating-decimal: {{ rating_decimal }};"></span>
         </div>
         <span class="product-card-1__reviews">({{ card_product.metafields.reviews.rating_count }})</span>
       </div>
     {%- endif -%}
  
     <h3 class="product-card-1__title"> 
       <a href="{{ card_product.url }}">{{ card_product.title }}</a> 
     </h3> 
  
     <div class="product-card-1__price"> 
       <span class="product-card-1__price-current">{{ card_product.price | money }}</span> 
       {% if card_product.compare_at_price > card_product.price %} 
         <span class="product-card-1__price-old">{{ card_product.compare_at_price | money }}</span> 
       {% endif %} 
     </div> 
  
     {%- if card_product.available -%}
      <a href="{{ card_product.url }}" class="product-card-1__btn-cart">
        <span class="product-card-1__btn-text">Adicionar no carrinho</span>
        <span class="product-card-1__btn-icon">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="9" cy="21" r="1"></circle>
            <circle cx="20" cy="21" r="1"></circle>
            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
          </svg>
        </span>
      </a>
    {%- else -%}
      <button class="product-card-1__btn-cart" disabled>
        Sold out
      </button>
    {%- endif -%}
     {% comment %}
     <form action="/cart/add" method="post" class="product-card-1__form"> 
       <input type="hidden" name="id" value="{{ card_product.selected_or_first_available_variant.id }}"> 
       <button type="submit" class="product-card-1__btn-cart" {% unless card_product.available %}disabled{% endunless %}> 
         {% if card_product.available %}
           <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/></svg> 
           Add to Cart 
         {% else %}
           Sold out
         {% endif %}
       </button> 
     </form>
     {% endcomment %}
   </div> 
 </div>
{%- else -%}
  <div class="product-card-1">
    <div class="product-card-1__image-wrap">
      {{ placeholder_image | default: 'product-apparel-2' | placeholder_svg_tag: 'placeholder-svg' }}
    </div>
    <div class="product-card-1__info">
      <h3 class="product-card-1__title">Example Product Title</h3>
       <div class="product-card-1__price"> 
       <span class="product-card-1__price-current">{{ 1999 | money }}</span> 
     </div> 
    </div>
  </div>
{%- endif -%}